<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Prefer SVG (crisp at any size) -->
  <link rel="icon" type="image/svg+xml" href="./assets/logo.svg">

  <!-- PNG fallbacks (for older browsers) -->
  <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon-32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="./assets/favicon-192.png">

  <!-- iOS/Android home screen icon -->
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/apple-touch-icon-180.png">

  <!-- Optional: Safari pinned-tab monochrome icon (uses the SVG path) -->
  <link rel="mask-icon" href="./assets/logo.svg" color="#990000">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MOSAIC -- Indiana University</title>
  <meta name="description" content="MOSAIC offers graduate students a space to workshop research, build skills, and deepen methods expertise. Weekly meetings, dates and topics below." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui'] },
          colors: {
            brand: { /* IU crimson */
              50:'#FFF7F8',100:'#FFD6DB',200:'#FF9AA1',300:'#FF636A',400:'#F23A3F',
              500:'#DC231E',600:'#990000',700:'#800000',800:'#5A0C0C',900:'#3D0909'
            },
            accent: { /* gold */
              50:'#FFFCEB',100:'#FFF4C6',200:'#FFE694',300:'#FFD563',400:'#FFC132',
              500:'#FFAA00',600:'#A36B00',700:'#613D00',800:'#4B2F00',900:'#3A2400'
            }
          },
          boxShadow: { glow: '0 10px 30px rgba(153,0,0,.25)' }
        }
      }
    }
  </script>
  <style> html{scroll-behavior:smooth;} </style>
</head>
<body class="bg-white text-slate-900 antialiased">

  <!-- Nav -->
  <header class="sticky top-0 z-40 backdrop-blur bg-white/80 border-b border-slate-200">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
        <img src="./assets/logo.png" alt="MOSAIC logo" class="h-9 w-auto object-contain" />
        <span class="font-semibold tracking-tight">MOSAIC</span>
      </a>
      <nav class="hidden md:flex items-center gap-6 text-sm font-medium">
        <a href="#about" class="hover:text-brand-700">About</a>
        <a href="#schedule" class="hover:text-brand-700">Schedule</a>
        <a href="#contact" class="hover:text-brand-700">Contact</a>
      </nav>
      <a href="#schedule" class="ml-4 inline-flex items-center gap-2 rounded-xl border border-slate-300 bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-brand-600 hover:text-white hover:border-brand-600">
        View Schedule
      </a>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="pt-16 md:pt-20 pb-8 flex flex-col items-center text-center">
        <img src="./assets/logo.png" alt="MOSAIC logo" class="h-28 md:h-32 w-auto object-contain drop-shadow" />
        <h1 class="mt-5 text-4xl sm:text-5xl font-extrabold tracking-tight leading-tight">
          Methods of Social Analysis and Inquiry Colloquium
        </h1>
        <p class="mt-4 text-slate-600 max-w-2xl">
          MOSAIC offers graduate students a space to workshop research, acquire new skills,
          and sharpen understanding of social science research methods.
        </p>
        <div class="mt-6 flex flex-wrap gap-3 justify-center">
          <a href="#about" class="rounded-xl border border-slate-300 bg-slate-100 px-5 py-3 text-slate-700 font-semibold hover:bg-brand-600 hover:text-white hover:border-brand-600">About</a>
          <a href="#schedule" class="rounded-xl border border-slate-300 bg-slate-100 px-5 py-3 text-slate-700 font-semibold hover:bg-brand-600 hover:text-white hover:border-brand-600">Schedule</a>
          <button id="downloadIcs" class="rounded-xl border border-slate-300 bg-slate-100 px-5 py-3 text-slate-700 font-semibold hover:bg-brand-600 hover:text-white hover:border-brand-600">
            Add to Calendar (Download .ics)
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- About -->
  <section id="about" class="py-12 md:py-16">
    <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
      <div class="rounded-2xl border border-slate-200 p-6 bg-white">
        <h2 class="text-2xl sm:text-3xl font-bold tracking-tight">About the Workshop</h2>
        <p class="mt-3 text-slate-700">
          MOSAIC is a department-based methods colloquium. We run weekly sessions that rotate between:
          research presentations, methods demos, programming modules, and student labs. Questions or want to present? Email Caleb Lucas
          (<a href="mailto:lucascaj@iu.edu" class="text-brand-700 hover:underline">lucascaj@iu.edu</a>) or Harold Chambers (<a href="mailto:harrcham@iu.edu" class="text-brand-700 hover:underline">harrcham@iu.edu</a>).
        </p>
        <ul class="mt-4 text-slate-700 list-disc pl-6">
          <li>Open to all faculty and graduate students in the Department of Political Science.</li>
          <li>Bring work-in-progress: drafts, designs, data.</li>
          <li>Keep it constructive and specific.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Schedule -->
  <section id="schedule" class="py-16 md:py-20 bg-accent-50 border-y border-slate-200/70">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex items-end justify-between flex-wrap gap-6">
        <h2 class="text-2xl sm:text-3xl font-bold tracking-tight">This Semester’s Schedule</h2>
        <div class="text-sm text-slate-600">
          Fridays, <strong>10AM – 11AM</strong> Woodburn 218
        </div>
      </div>

      <div id="sessions" class="mt-8 grid sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>

      <!-- Card template -->
      <template id="sessionCard">
        <article class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm hover:shadow-xl transition-shadow">
          <div class="text-xs font-semibold text-brand-700 date"></div>
          <h3 class="mt-1 font-semibold title"></h3>
          <p class="mt-2 text-sm text-slate-700 desc"></p>
        </article>
      </template>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="py-16">
    <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
      <div class="rounded-2xl border border-slate-200 p-6 bg-white">
        <h2 class="text-2xl font-bold tracking-tight">Contact</h2>
        <p class="mt-2 text-slate-700">
          Questions or want to present? Email Caleb Lucas (<a href="mailto:lucascaj@iu.edu" class="text-brand-700 hover:underline">lucascaj@iu.edu</a>)
          or Harold Chambers (<a href="mailto:harrcham@iu.edu" class="text-brand-700 hover:underline">harrcham@iu.edu</a>).
        </p>
      </div>
      <p class="mt-6 text-center text-xs text-slate-500">
        © <span id="year"></span> Methods of Social Analysis and Inquiry Colloquium
      </p>
    </div>
  </section>

  <script>
    // Run when DOM is ready (robust even if script moves)
    window.addEventListener('DOMContentLoaded', () => {
      // ===== FIXED SEMESTER SETTINGS =====
      const TZID = 'America/Indiana/Indianapolis';
      const MEETING_DAY = 5; // 0=Sun ... 5=Fri
      const TIME_START = { hour: 10, minute: 0 };
      const TIME_END   = { hour: 11, minute: 0 };
      const SEMESTER_START = new Date('September 5, 2025 10:00');
      const SEMESTER_END   = new Date('December 12, 2025 11:00');

      // Optional: first session seeded; others rotate topics
      const seeded = [
        { date: '2025-09-05', title: 'Graduate Lab', desc: 'Collaborative discussion, problem solving, and accountability.' },

        // NEW: Oct 10 — Visualization Clinic (Data viz lab)
        { date: '2025-10-10', title: 'Visualization Clinic', desc: 'Design clearer figures. Interactive visualizations to explore data and motivate analysis. ggplot2, plotly, Shiny.' },

        // NEW: Nov 14 — Adams presents
        { date: '2025-11-14', title: 'Paper Workshop: Adams', desc: 'Mary Adams. Work-in-progress presentation and discussion.' },

        // NEW: Dec 12 — Chen presents (9–10am)
        {
          date: '2025-12-12',
          title: 'Paper Workshop: Chen (9am-10am)',
          desc: 'Kejun Chen. Work-in-progress presentation and discussion.',
          time: { start: { hour: 9, minute: 0 }, end: { hour: 10, minute: 0 } }
        }
      ];

      // ===== CANCELED / BLACKOUT DATES (no meeting) =====
      const blackouts = [
        { date: '2025-10-03', reason: 'No meeting — Third-year paper presentations' },
        { date: '2025-10-24', reason: 'No meeting — Teaching workshop' },
        { date: '2025-10-31', reason: 'No meeting — American Politics Conference' },
        { date: '2025-11-28', reason: 'No meeting — Thanksgiving' },
      ];

      const topics = [
        { title: 'Graduate Lab', desc: 'Collaborative discussion, problem solving, and accountability.' },
        { title: 'Graduate Lab', desc: 'Collaborative discussion, problem solving, and accountability.' },
        { title: 'Paper Workshops: Kim', desc: 'Joohyun Kim. Work-in-progress presentation and discussion.' },
        { title: 'Paper Workshops: Chambers and Lee', desc: 'Harold Chambers and Inwoo Lee. Work-in-progress presentation and discussion.' },
        { title: 'Visualization Clinic', desc: 'Design clearer figures. Interactive visualizations to explore data and motivate analysis. ggplot2, plotly, Shiny.' },
        { title: 'Graduate Lab', desc: 'Collaborative discussion, problem solving, and accountability.' },
        { title: 'Webscraping 101', desc: 'Digest the internet. Basics of extracting data from websites using code.' },
        { title: 'Paper Workshop: Adams', desc: 'Mary Adams. Work-in-progress presentation and discussion.' },
        { title: 'Paper Workshop: Oduncu', desc: 'Ramazan Oduncu. Work-in-progress presentation and discussion.' },
        { title: 'Computational Text Analysis', desc: 'Generate inferences using text analysis. Focus on AI/ML applications alongside traditional models.' },
        { title: 'Graduate Lab', desc: 'Collaborative discussion, problem solving, and accountability.' },
        { title: 'Paper Workshop: Decourt', desc: 'William Decourt. Work-in-progress presentation and discussion.' },
        {
          title: 'Paper Workshop: Chen (9am-10am)',
          desc: 'Kejun Chen. Work-in-progress presentation and discussion.',
          // <- one-off time override (9–10am)
          time: { start: { hour: 9, minute: 0 }, end: { hour: 10, minute: 0 } }
        },
        { title: 'Paper Workshop: Kang', desc: 'Sungsik Kang. Work-in-progress presentation and discussion.' }
      ];

      // ===== HELPERS =====
      const fmtDate = (d) =>
        d.toLocaleDateString(undefined, { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' });

      const fmtTime = (d) => {
        let h = d.getHours(), m = d.getMinutes();
        const ampm = h >= 12 ? 'PM' : 'AM';
        h = h % 12 || 12;
        return `${h}${m ? ':' + String(m).padStart(2, '0') : ''} ${ampm}`;
      };
      const fmtTimeRange = (a, b) => `${fmtTime(a)}–${fmtTime(b)}`;

      function nextDateOnOrAfter(start, weekday) {
        const d = new Date(start);
        d.setHours(0,0,0,0);
        const delta = (weekday - d.getDay() + 7) % 7;
        d.setDate(d.getDate() + delta);
        return d;
      }

      function setTime(d, h, m) {
        const x = new Date(d);
        x.setHours(h, m ?? 0, 0, 0);
        return x;
      }

      function weeklyBetween(start, end) {
        const out = [];
        let d = new Date(start);
        while (d <= end) {
          out.push(new Date(d));
          d.setDate(d.getDate() + 7);
        }
        return out;
      }

      // ===== BUILD SESSIONS =====
      const firstFriday = nextDateOnOrAfter(SEMESTER_START, MEETING_DAY);
      const dates = weeklyBetween(firstFriday, SEMESTER_END);
      const sessionStarts = dates.map(d => setTime(d, TIME_START.hour, TIME_START.minute));
      const sessionEnds   = dates.map(d => setTime(d, TIME_END.hour, TIME_END.minute));

      // Map seeded by ISO date (local)
      const seedMap = new Map();
      for (const s of seeded) {
        if (s.date) {
          const key = new Date(s.date + 'T00:00:00').toDateString();
          seedMap.set(key, s);
        }
      }

      // Map blackouts by local date string
      const blackoutMap = new Map();
      for (const b of blackouts) {
        const key = new Date(b.date + 'T00:00:00').toDateString();
        blackoutMap.set(key, b);
      }

      const sessions = sessionStarts.map((start, i) => {
        const end = sessionEnds[i];
        const key = new Date(start.getFullYear(), start.getMonth(), start.getDate()).toDateString();

        // Blackout (canceled) days
        if (blackoutMap.has(key)) {
          const { reason } = blackoutMap.get(key);
          return {
            start, end,
            title: 'No Meeting',
            desc: reason,
            canceled: true
          };
        }

        // Seeded overrides first
        if (seedMap.has(key)) {
          const s = seedMap.get(key);
          let sStart = start, sEnd = end;
          if (s.time) {
            sStart = setTime(start, s.time.start.hour, s.time.start.minute);
            sEnd   = setTime(end,   s.time.end.hour,   s.time.end.minute);
          }
          return { start: sStart, end: sEnd, title: s.title, desc: s.desc, canceled: false };
        }

        // Otherwise rotate topics (allow per-topic time overrides)
        const t = topics[i % topics.length];
        let tStart = start, tEnd = end;
        if (t.time) {
          tStart = setTime(start, t.time.start.hour, t.time.start.minute);
          tEnd   = setTime(end,   t.time.end.hour,   t.time.end.minute);
        }
        return { start: tStart, end: tEnd, title: t.title, desc: t.desc, canceled: false };
      });

      // ===== RENDER =====
      const wrap = document.getElementById('sessions');
      const tpl = document.getElementById('sessionCard');

      if (sessions.length === 0) {
        const msg = document.createElement('div');
        msg.className = 'p-6 rounded-xl border border-slate-200 bg-white text-sm';
        msg.textContent = 'No sessions generated. Please check the semester dates.';
        wrap.appendChild(msg);
      } else {
        sessions.forEach(s => {
          const node = tpl?.content ? tpl.content.cloneNode(true) : document.createElement('article');
          if (!tpl?.content) {
            node.className = 'rounded-2xl border border-slate-200 bg-white p-6 shadow-sm';
            node.innerHTML = `<div class="text-xs font-semibold text-brand-700 date"></div><h3 class="mt-1 font-semibold title"></h3><p class="mt-2 text-sm text-slate-700 desc"></p>`;
          }

          // Ensure we can style the card even when using a template fragment
          const cardEl  = node.querySelector('article') || node;
          const dateEl  = node.querySelector('.date')  || node;
          const titleEl = node.querySelector('.title') || node;
          const descEl  = node.querySelector('.desc')  || node;

          if (s.canceled) {
            cardEl.classList.add('bg-slate-50', 'opacity-90');
            dateEl.textContent  = `${fmtDate(s.start)} • —`;
            titleEl.textContent = 'No Meeting';
            descEl.textContent  = s.desc;
          } else {
            dateEl.textContent  = `${fmtDate(s.start)} • ${fmtTimeRange(s.start, s.end)}`;
            titleEl.textContent = s.title;
            descEl.textContent  = s.desc;
          }

          wrap.appendChild(node);
        });
      }

      // Footer year
      const y = document.getElementById('year');
      if (y) y.textContent = String(new Date().getFullYear());

      // ===== ICS EXPORT (with local TZ) =====
      function pad2(n){ return String(n).padStart(2,'0'); }
      function fmtICSLocal(d) {
        // Local "floating" time (no Z) with HHMMSS
        return `${d.getFullYear()}${pad2(d.getMonth()+1)}${pad2(d.getDate())}T${pad2(d.getHours())}${pad2(d.getMinutes())}00`;
      }

      function makeICS(events){
        const lines = [
          'BEGIN:VCALENDAR',
          'VERSION:2.0',
          'PRODID:-//Methods of Social Analysis and Inquiry Colloquium//EN'
          // (Most clients understand TZID without an embedded VTIMEZONE;
          // add VTIMEZONE if your client complains.)
        ];
        events.forEach((s, idx) => {
          const uid = `mosaic-${s.start.getTime()}-${idx}@example.edu`;
          lines.push(
            'BEGIN:VEVENT',
            `UID:${uid}`,
            `DTSTAMP:${fmtICSLocal(new Date())}`,
            `SUMMARY:MOSAIC: ${s.title}`,
            `DESCRIPTION:${s.desc.replace(/\n/g, '\\n')}`,
            `DTSTART;TZID=${TZID}:${fmtICSLocal(s.start)}`,
            `DTEND;TZID=${TZID}:${fmtICSLocal(s.end)}`,
            'END:VEVENT'
          );
        });
        lines.push('END:VCALENDAR');
        return lines.join('\r\n');
      }

      const dlBtn = document.getElementById('downloadIcs');
      if (dlBtn) {
        dlBtn.addEventListener('click', () => {
          // Exclude canceled sessions from the ICS
          const ics = makeICS(sessions.filter(s => !s.canceled));
          const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'MOSAIC_Fall_2025_Fridays_10-11am.ics';
          document.body.appendChild(a);
          a.click();
          a.remove();
          URL.revokeObjectURL(url);
        });
      }
    });
  </script>
</body>
</html>
